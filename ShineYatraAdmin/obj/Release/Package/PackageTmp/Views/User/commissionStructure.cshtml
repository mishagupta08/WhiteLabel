@using ShineYatraAdmin.Properties;
@using ShineYatraAdmin.Entity;
@model ShineYatraAdmin.Entity.UserViewModel
@{
    Layout = "~/Views/Shared/Layout.cshtml";
    int count = 1;
}

<div class="row">
    <div class="col-md-12">
        <div class="white-box">

            <!-- Tabstyle start -->
            <h3 class="box-title m-b-0">@*@Model.company_name*@</h3>
            <code>Commission Structure</code><hr>
            @*@Html.HiddenFor(m => m.cmp_setting_id, new { @id = "CompanySettingId" })*@
            <section>
                <div class="sttabs tabs-style-bar">
                    <nav>
                        <ul class="tablist">
                            @{List<string> groups = (from r in Model.services select r.service_group).Distinct().ToList();}
                            @foreach (var service in groups)
                            {
                                string action = "";
                                if (service.ToLower().IndexOf("flight") != -1)
                                {
                                    action = "getCommissionGroupDetails('" + Model.membergroups.flight_group_id + "','section-bar-" + count + "')";
                                }
                                else if (service.ToLower().IndexOf("bus") != -1)
                                {
                                    action = "getCommissionGroupDetails('" + Model.membergroups.bus_group_id + "', 'section-bar-" + count + "')";
                                }
                                else if (service.ToLower().IndexOf("hotel") != -1)
                                {
                                    action = "getCommissionGroupDetails('" + Model.membergroups.hotel_group_id + "','section-bar-" + count + "')";
                                }
                                else if (service.ToLower().IndexOf("recharge") != -1)
                                {
                                    //action = "getRechargeCommissionStructure('" + ShineYatraSession.LoginUser.company_id + "', 'section-bar-" + count + "')";
                                }
                                <li id="tab-@count" onclick="@action"><a href="#section-bar-@count"><span>@service</span></a></li>
                                count = count + 1;
                            }
                        </ul>
                    </nav>
                    <div class="content-wrap">

                        @{ count = 1;}
                        @foreach (var g in groups)
                        {
                            <section id="section-bar-@count"><br /><br /><br /><p>Loading please wait...</p></section>
                            count = count + 1;
                        }
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

<a class="popup-with-form btn btn-success" href="#change-group" id="openchangepopup" style="display:none;">Open form</a>
<form id="change-group" class="form-horizontal form-bordered mfp-hide white-popup-block" onsubmit="return false" style="max-width: 800px;">
    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-info">
                <div class="panel-heading"> Apply Price Group To Company</div>
                <div class="panel-wrapper collapse in" aria-expanded="true">
                    <div class="panel-body">
                        <div class="form-body">

                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Price Group </label>
                                    <select class="form-control" id="price_group_list"></select>
                                    <span style="color:red;" id="pricegroupError"></span>
                                    <input type="hidden" id="companyid" value="">
                                    <input type="hidden" id="serviceid" value="">
                                </div>

                            </div>



                        </div>
                        <div class="form-actions">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="row">
                                        <div class="col-md-offset-3 col-md-9">
                                            <button type="button" onclick="EditCompanyPriceGroup()" class="btn btn-success"> <i class="fa fa-check"></i> Apply This</button>
                                            <button type="button" class="btn btn-default" onclick="closePopup()">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

<a class="popup-with-form btn btn-success" href="#commissionrecchargepercent" id="opencommissionrecchargepercent" style="display:none;">Open form</a>
<form id="commissionrecchargepercent" class="form-horizontal form-bordered mfp-hide white-popup-block" onsubmit="return SubmitCompanyRechargeSetting('commissionrecchargepercent');" style="max-width: 800px;"></form>

<script src="~/Script/companyCommision.js"></script>
<script src="~/plugins/bower_components/jquery/dist/jquery.min.js"></script>
<script>
    $(document).ready(function () {      
        $("#tab-1").click();
        $(".preloader").show();
    //    var currentTab = sessionStorage.getItem('currentTab');
    //    if (currentTab != undefined && currentTab != "" && currentTab != null)
    //        {
    //            $('.tablist .tab-current').removeClass('tab-current');
    //            $("#" + currentTab).addClass("tab-current");
    //            var arr = currentTab.split("-");
    //            $('.content-wrap .content-current').removeClass('content-current');
    //            $("#section-bar-" + arr[1]).addClass("content-current");
    //            $("#" + currentTab).click();
    //            sessionStorage.setItem("currentTab",'');
    //        }
    });
</script>