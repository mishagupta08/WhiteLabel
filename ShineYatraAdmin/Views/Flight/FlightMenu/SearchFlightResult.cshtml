@model ShineYatraAdmin.Entity.SearchPageViewModel
@{
    ViewBag.Title = "SearchFlightResult";
    Layout = "~/Views/Shared/Layout.cshtml";
    int i = 0, count = 0;
}
<style>
    DIV.table {
        display: table;
    }

    FORM.tr, DIV.tr {
        display: table-row;
    }

    SPAN.td {
        display: table-cell;
    }
</style>

<div class="row">
    <div class="col-md-12">
        <div class="panel panel-info">
            <div class="panel-heading">Flight Search REsult</div>
            <div class="panel-wrapper collapse in" aria-expanded="true">
                <div class="panel-body">
                    <h6>@Model.flightSearch.Origin - @Model.flightSearch.Destination</h6>
                    <h6>Depart :- @Model.flightSearch.DepartDate</h6>
                    @*<h6>Arrival :- @Model.flightSearch.ArrivalDateTime</h6>*@
                    <h6>@Model.flightSearch.FlightType</h6>
                    <h6>@Model.flightSearch.AdultPax Adult, @Model.flightSearch.ChildPax Children, @Model.flightSearch.InfantPax InfantPaxs</h6>

                    <div class="table">

                                @if (Model.arrayOfSearchedFlights.FlightsDetail == null)
                                {
                                 <div class="col-md-12">No Flights Available</div>
                                }
                                else
                                {
                                var FlightList = Model.arrayOfSearchedFlights.FlightsDetail
                                .GroupBy(u => u.Id)
                                .Select(grp => grp.ToList())
                                .ToList();

                                foreach (var flightrow in FlightList)
                                {
                                count = flightrow.Count();
                                count = count - 1;


                                <form class="tr" method="post" action="BookFlight">
                                    <input type="hidden" value="@Model.flightSearch.AdultPax" name="AdultPax">
                                    <input type="hidden" value="@Model.flightSearch.ChildPax" name="ChildPax">
                                    <input type="hidden" value="@Model.flightSearch.InfantPax" name="InfantPax">
                                    <input type="hidden" value="@Model.flightSearch.Origin" name="Origin">
                                    <input type="hidden" value="@Model.flightSearch.DepartDate" name="DepartDate">
                                    <input type="hidden" value="@Model.flightSearch.FlightType" name="FlightType">
                                    <input type="hidden" value="@Model.flightSearch.Mode" name="Mode">
                                    <input type="hidden" value="@Model.flightSearch.Destination" name="Destination">
                                    <input type="hidden" value="@Model.flightSearch.Preferredclass" name="Preferredclass" />

                                    <div class="col-md-12">
                                        <div class="col-md-1">
                                            <input type="hidden" value="@flightrow.First().Id" name="Id">
                                            <input type="hidden" value="@flightrow.First().FlightNumber" name="FlightNumber">
                                            <span>@flightrow.First().AirLineName</span><span class="td">@flightrow.First().Id</span>
                                        </div>
                                        <div class="col-md-3"><span class="td">@flightrow.First().DepartureDateTime (@flightrow.First().DepartureAirportCode)</span></div>
                                        <div class="col-md-2"> ----@count stops---- </div>
                                        <div class="col-md-3"><span class="td">@flightrow.Last().ArrivalDateTime (@flightrow.Last().ArrivalAirportCode)</span></div>
                                        <div class="col-md-1">
                                            <span class="td">@flightrow.First().Availability seats </span>
                                        </div>
                                        <div class="col-md-2">
                                            <span class="td" style="float:left;">Price :- @flightrow.First().BookingClassFare.AdultFare</span><br />
                                            <span class="td" style="float:right;">
                                                <input type="submit" value="Book Ticket">
                                            </span>
                                            <a id="viewRuleLink_@i" onclick="viewRule('notefor_@i','viewRuleLink_@i')">Rule</a>
                                        </div>
                                    </div>
                                    <div class="col-lg-12" id="notefor_@i" style="display:none;padding:3%;">
                                        @if (count > 0)
                                        {
                                            <div class="col-md-12">
                                                <h4>Stop Details</h4>
                                            </div>
                                            foreach (var flight in flightrow)
                                            {
                                                <div class="col-md-12">
                                                    <div class="col-md-2">  </div>
                                                    <div class="col-md-2">
                                                        <span>@flight.AirLineName - @flight.FlightNumber</span>
                                                    </div>

                                                    <div class="col-md-3"><span class="td">@flight.DepartureDateTime (@flight.DepartureAirportCode)</span></div>

                                                    <div class="col-md-3"><span class="td">@flight.ArrivalDateTime (@flight.ArrivalAirportCode)</span></div>

                                                    <div class="col-md-2">
                                                    </div>
                                                </div>
                                            }

                                            <div class="col-lg-12"><hr></div>
                                        }
                                        <div class="col-md-12">
                                            <h4>Flight Rules</h4>
                                        </div>
                                        <div class="col-lg-12">
                                            @flightrow.First().BookingClassFare.Rule
                                        </div>
                                    </div>
                                </form>
                                <div class="col-md-12">
                                    <hr>
                                </div>
                                i = i + 1;
                                }
                             }
                            </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/Script/flight.js"></script>